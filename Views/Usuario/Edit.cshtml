@model inmobiliaria.Models.Usuario

@{
    ViewData["Title"] = "Modificar Usuario";
}

<div class="container mt-5">
    <div class="card shadow-lg rounded-4 border-0 p-4 mx-auto" style="max-width: 600px;">
        <div class="text-center mb-4">
            <i class="bi bi-person-fill display-3 text-purple"></i>
            <h3 class="fw-bold text-purple mt-2">Modificación de Usuario</h3>
            <p class="text-muted">Actualice la información del usuario</p>
        </div>

        <form asp-action="Edit" method="post" enctype="multipart/form-data">
            <input type="hidden" asp-for="id_usuario" />

            <div class="mb-3">
                <label asp-for="nombre_usuario" class="form-label fw-semibold text-purple">Nombre:</label>
                <input asp-for="nombre_usuario" class="form-control rounded-3 shadow-sm" />
                <span asp-validation-for="nombre_usuario" class="text-danger small"></span>
            </div>

            <div class="mb-3">
                <label asp-for="apellido_usuario" class="form-label fw-semibold text-purple">Apellido:</label>
                <input asp-for="apellido_usuario" class="form-control rounded-3 shadow-sm" />
                <span asp-validation-for="apellido_usuario" class="text-danger small"></span>
            </div>

            <div class="mb-3">
                <label asp-for="email_usuario" class="form-label fw-semibold text-purple">Email:</label>
                <input asp-for="email_usuario" type="email" class="form-control rounded-3 shadow-sm" />
                <span asp-validation-for="email_usuario" class="text-danger small"></span>
            </div>

            <div class="mb-3">
                <label asp-for="password_usuario" class="form-label fw-semibold text-purple">Contraseña:</label>
                <input asp-for="password_usuario" class="form-control rounded-3 shadow-sm" type="password" />
                <span asp-validation-for="password_usuario" class="text-danger small"></span>
            </div>

            @if (User.IsInRole("Administrador"))
            {
                <div class="mb-3">
                    <label asp-for="rol_usuario" class="form-label fw-semibold text-purple">Rol:</label>
                    <select asp-for="rol_usuario" class="form-select rounded-3 shadow-sm">
                        <option value="">Seleccione un rol</option>
                        <option value="Administrador">Administrador</option>
                        <option value="Empleado">Empleado</option>
                    </select>
                    <span asp-validation-for="rol_usuario" class="text-danger small"></span>
                </div>
            }

            <div class="mb-3">
                <label asp-for="avatar_form" class="form-label fw-semibold text-purple">Avatar:</label>
                <input type="file" asp-for="avatar_form" class="form-control rounded-3 shadow-sm" accept="image/*"
                    id="avatarInput" />
                <span asp-validation-for="avatar_form" class="text-danger small"></span>
            </div>

            <div class="form-check mb-3">
                <input class="form-check-input" type="checkbox" id="eliminarAvatar" name="EliminarAvatar"
                    value="true" />
                <label class="form-check-label fw-semibold text-purple" for="eliminarAvatar">Eliminar avatar</label>
            </div>

            <div class="d-flex justify-content-between mt-4">
                <a asp-action="Index" class="btn btn-gradient-success fw-semibold rounded-3 shadow-sm px-4">
                    <i class="bi bi-arrow-left"></i> Cancelar
                </a>
                <button type="submit" class="btn btn-gradient-success fw-semibold rounded-3 shadow-sm px-4">
                    <i class="bi bi-save"></i> Modificar
                </button>
            </div>
        </form>
        @if (!ViewData.ModelState.IsValid)
        {
            <div class="alert alert-danger mt-3 small">
                <strong>Se encontraron errores:</strong>
                <ul>
                    @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                    {
                        <li>@error.ErrorMessage</li>
                    }
                </ul>
            </div>
        }
    </div>
</div>

<script>
    const avatarInput = document.getElementById("avatarInput");
    const checkbox = document.getElementById("eliminarAvatar");
    checkbox.addEventListener("change", function () {
        if (checkbox.checked) {
            avatarInput.disabled = true;
            avatarInput.value = "";
        } else {
            avatarInput.disabled = false;
        }
    });
</script>